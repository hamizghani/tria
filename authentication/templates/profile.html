{% load static %}

{% block meta %}
<style>
    :root {
        --tria-red: #e53935;
        --tria-orange: #ff9800;
        --tria-soft-bg: #fff7ec;
        --tria-border: #f0e0d8;
        --tria-text: #222;
        --tria-muted: #666;
    }

    body {
        margin: 0;
        padding: 0;
        background: #ffffff;
        color: var(--tria-text);
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
            Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    }

    a {
        text-decoration: none;
        color: inherit;
    }

    /* NAVBAR â€“ same style as other pages */
    .navbar {
        background-color: #ffffff;
        border-bottom: 1px solid #f3eee7;
        position: sticky;
        top: 0;
        z-index: 50;
        backdrop-filter: blur(10px);
    }

    .nav-inner {
        max-width: 1100px;
        margin: 0 auto;
        padding: 0.75rem 1.5rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 1rem;
    }

    .nav-brand {
        display: flex;
        align-items: center;
        gap: 0.6rem;
    }

    .nav-logo {
        height: 36px;
        width: 36px;
        object-fit: contain;
    }

    .nav-title {
        font-weight: 700;
        letter-spacing: 0.03em;
        font-size: 1.1rem;
    }

    .nav-links {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        font-size: 0.95rem;
    }

    .nav-link {
        padding: 0.4rem 0.75rem;
        border-radius: 999px;
        transition: background-color 0.2s ease, color 0.2s ease, transform 0.1s ease;
    }

    .nav-link:hover {
        background-color: #fff1df;
        color: var(--tria-red);
        transform: translateY(-1px);
    }

    .nav-cta {
        background: linear-gradient(135deg, var(--tria-red), var(--tria-orange));
        color: #ffffff;
        font-weight: 600;
    }

    .nav-cta:hover {
        background: linear-gradient(135deg, #c62828, #fb8c00);
        color: #ffffff;
    }

    .nav-avatar {
        width: 34px;
        height: 34px;
        border-radius: 8px;
        background: linear-gradient(135deg,#e53935,#ff9800);
        color: #fff;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 0.95rem;
    }

    /* PROFILE ----------------------------------------------------- */

    .profile-container {
        max-width: 900px;
        margin: 2.5rem auto;
        padding: 1rem 1.25rem;
    }

    .profile-card {
        background: #fff;
        border: 1px solid var(--tria-border);
        border-radius: 16px;
        padding: 1.75rem 1.75rem 1.5rem;
        box-shadow: 0 16px 40px rgba(0,0,0,0.05);
    }

    .profile-header {
        display: flex;
        align-items: center;
        gap: 1.25rem;
    }

    .avatar {
        width: 80px;
        height: 80px;
        border-radius: 18px;
        background: linear-gradient(135deg,var(--tria-red),var(--tria-orange));
        color: #fff;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 800;
        font-size: 1.5rem;
        box-shadow: 0 10px 26px rgba(229,57,53,0.35);
    }

    .profile-main {
        flex: 1;
    }

    .profile-name {
        font-size: 1.35rem;
        font-weight: 800;
        margin: 0 0 0.1rem 0;
    }

    .profile-username {
        font-size: 0.9rem;
        color: var(--tria-muted);
        margin: 0 0 0.35rem 0;
    }

    .profile-email {
        font-size: 0.92rem;
        color: var(--tria-text);
    }

    .profile-tag {
        display: inline-flex;
        align-items: center;
        gap: 0.3rem;
        background: var(--tria-soft-bg);
        border-radius: 999px;
        padding: 0.15rem 0.6rem;
        font-size: 0.8rem;
        color: var(--tria-red);
        margin-top: 0.4rem;
        font-weight: 600;
    }

    .profile-body {
        margin-top: 1.75rem;
        border-top: 1px solid #f4e5dd;
        padding-top: 1.25rem;
    }

    .profile-intro {
        margin: 0 0 1.25rem 0;
        font-size: 0.94rem;
        color: var(--tria-muted);
    }

    .info-grid {
        display: grid;
        grid-template-columns: repeat(2,minmax(0,1fr));
        gap: 1rem 2rem;
        margin-bottom: 1.75rem;
    }

    .info-item {
        font-size: 0.9rem;
    }

    .info-label {
        font-size: 0.78rem;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: var(--tria-muted);
        margin-bottom: 0.2rem;
    }

    .info-value {
        font-weight: 600;
        color: var(--tria-text);
    }

    .profile-actions {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
        align-items: center;
    }

    .btn-logout,
    .btn-edit {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 0.7rem 1.3rem;
        border-radius: 999px;
        font-weight: 700;
        font-size: 0.9rem;
        border: none;
        cursor: pointer;
        transition: background-color 0.2s ease, color 0.2s ease,
                    box-shadow 0.2s ease, transform 0.1s ease,
                    border-color 0.2s ease, opacity 0.12s ease;
    }

    .btn-logout {
        background: linear-gradient(135deg,var(--tria-red),var(--tria-orange));
        color: #fff;
        box-shadow: 0 10px 26px rgba(229,57,53,0.25);
    }

    .btn-logout:hover {
        transform: translateY(-1px);
        box-shadow: 0 14px 32px rgba(229,57,53,0.32);
        opacity: 0.97;
    }

    .btn-edit {
        background: #fff;
        color: var(--tria-red);
        border: 1px solid rgba(229,57,53,0.4);
    }

    .btn-edit:hover {
        background: #fff7ec;
        transform: translateY(-1px);
        box-shadow: 0 8px 18px rgba(229,57,53,0.15);
    }

    .helper-text {
        font-size: 0.82rem;
        color: var(--tria-muted);
    }

    /* MODAL EDIT PROFILE ------------------------------------------- */

    .modal-overlay {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.35);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 60;
    }

    .modal-overlay.open {
        display: flex;
    }

    .modal-card {
        background: #fff;
        border-radius: 16px;
        padding: 1.6rem 1.75rem 1.5rem;
        width: 100%;
        max-width: 420px;
        box-shadow: 0 18px 45px rgba(0,0,0,0.22);
        position: relative;
    }

    .modal-title {
        font-size: 1.2rem;
        font-weight: 700;
        margin: 0 0 0.4rem 0;
    }

    .modal-subtitle {
        font-size: 0.86rem;
        color: var(--tria-muted);
        margin-bottom: 1rem;
    }

    .modal-field {
        margin-bottom: 0.9rem;
    }

    .modal-label {
        display: block;
        font-size: 0.82rem;
        font-weight: 600;
        margin-bottom: 0.3rem;
        color: var(--tria-muted);
    }

    .modal-input {
        width: 100%;
        padding: 0.55rem 0.7rem;
        border-radius: 8px;
        border: 1px solid #e0d2c8;
        font-size: 0.9rem;
        font-family: inherit;
    }

    .modal-input:focus {
        outline: none;
        border-color: var(--tria-orange);
        box-shadow: 0 0 0 2px rgba(255,152,0,0.25);
    }

    .modal-actions {
        display: flex;
        justify-content: flex-end;
        gap: 0.6rem;
        margin-top: 1rem;
    }

    .btn-cancel {
        background: #fff;
        color: var(--tria-muted);
        border: 1px solid #ddd;
        padding: 0.55rem 1.1rem;
        border-radius: 999px;
        font-size: 0.86rem;
        cursor: pointer;
    }

    .btn-save {
        background: linear-gradient(135deg,var(--tria-red),var(--tria-orange));
        color: #fff;
        border: none;
        padding: 0.55rem 1.25rem;
        border-radius: 999px;
        font-size: 0.86rem;
        cursor: pointer;
        box-shadow: 0 8px 20px rgba(229,57,53,0.28);
    }

    .btn-save:hover {
        transform: translateY(-1px);
    }

    @media (max-width: 720px) {
        .profile-container {
            margin: 1.5rem auto;
            padding-inline: 0.9rem;
        }
        .profile-card {
            padding: 1.4rem 1.2rem 1.4rem;
        }
        .profile-header {
            align-items: flex-start;
        }
        .info-grid {
            grid-template-columns: minmax(0,1fr);
        }
        .modal-card {
            margin-inline: 1rem;
        }
    }
</style>
{% endblock %}

{% block content %}

{% include "partials/navbar.html" %}

<main class="profile-container">
    <section class="profile-card">
        <!-- HEADER: avatar + main identity -->
        <header class="profile-header">
            <div class="avatar">
                {{ user.username|slice:":1"|upper }}
            </div>
            <div class="profile-main">
                <p class="profile-name">
                    {{ user.get_full_name|default:user.username }}
                </p>
                <p class="profile-username">
                    @{{ user.username }}
                </p>
               
                <span class="profile-tag">
                    Akun Tria
                </span>
            </div>
        </header>

        <!-- BODY: account info -->
        <section class="profile-body">
            <p class="profile-intro">
                Di halaman ini kamu bisa melihat informasi akunmu dan keluar dari sesi Tria dengan aman.
            </p>

            <div class="info-grid">
                <div class="info-item">
                    <div class="info-label">Username</div>
                    <div class="info-value">
                        {{ user.username }}
                    </div>
                </div>
                <div class="info-item">
                    <div class="info-label">Bergabung Sejak</div>
                    <div class="info-value">
                        {{ user.date_joined|date:"d M Y" }}
                    </div>
                </div>
            </div>

            <!-- ACTIONS -->
            <div class="profile-actions">
            

                <form method="post" action="{% url 'authentication:logout' %}">
                    {% csrf_token %}
                    <button type="submit" class="btn-logout">
                        Logout
                    </button>
                </form>

                <p class="helper-text">
                    Setelah logout, kamu bisa login kembali kapan saja untuk melanjutkan belajar tarian.
                </p>
            </div>
        </section>
    </section>
</main>

<!-- EDIT PROFILE MODAL -->
<div id="editModal" class="modal-overlay">
    <div class="modal-card">
        <h2 class="modal-title">Edit Profil</h2>
        <p class="modal-subtitle">
            Ubah nama lengkap dan emailmu. Perubahan akan disimpan setelah kamu menekan tombol <strong>Simpan</strong>.
        </p>

        <form method="post" action="">
            {% csrf_token %}
            <div class="modal-field">
                <label class="modal-label" for="full_name">Nama Lengkap</label>
                <input
                    type="text"
                    id="full_name"
                    name="full_name"
                    class="modal-input"
                    value="{{ user.get_full_name }}"
                />
            </div>

            <div class="modal-field">
                <label class="modal-label" for="email">Email</label>
                <input
                    type="email"
                    id="email"
                    name="email"
                    class="modal-input"
                    value="{{ user.email }}"
                />
            </div>

            <div class="modal-actions">
                <button type="button" class="btn-cancel" id="cancelEditBtn">Batal</button>
                <button type="submit" class="btn-save">Simpan</button>
            </div>
        </form>
    </div>
</div>

<script>
    const editBtn = document.getElementById('editProfileBtn');
    const modal = document.getElementById('editModal');
    const cancelBtn = document.getElementById('cancelEditBtn');

    if (editBtn && modal && cancelBtn) {
        editBtn.addEventListener('click', () => {
            modal.classList.add('open');
        });

        cancelBtn.addEventListener('click', () => {
            modal.classList.remove('open');
        });

        // close when clicking outside the modal card
        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.classList.remove('open');
            }
        });
    }
</script>

{% endblock %}
